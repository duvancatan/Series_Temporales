df_w <- diffseries(w$series, d_est)
par(mfrow = c(2, 1))
acf(df_z, ci=0)
pacf(df_z, ci=0)
par(mfrow = c(2, 1))
acf(df_w, ci=0)
pacf(df_w, ci=0)
modelo2 <- fracdiff(z$series, nar = 1, nma = 0,dtol = NULL, drange = c(0, 0.5), M = 100)
w<-fracdiff.sim(600, ma=0.7 , d=0.35)
plot(as.ts(w$series))
acf(z, lag.max=150)
df_w<-diffseries(w$series, 0.35)
par(mfrow = c(3, 1))
plot(df_w, type="l")
acf(df_w, ci=0)
pacf(df_w, ci=0)
acf(df_w)
pacf(df_w, ci=0)
modelo1<-fracdiff(w$series, nar = 4, nma = 4, dtol = NULL, drange = c(0, 0.5), M = 100)
modelo1<-fracdiff(w$series, nar = 4, nma = 4, dtol = NULL, drange = c(0, 0.5), M = 100)
w<-fracdiff.sim(600, ma=0.7 , d=0.35)
plot(as.ts(w$series))
acf(z, lag.max=150)
# Verificación teórica del procedimiento
df_w<-diffseries(w$series, 0.35)
par(mfrow = c(3, 1))
plot(df_w, type="l")
acf(df_w)
pacf(df_w, ci=0)
# Procedimiento de Identificación
# Paso 1
modelo1<-fracdiff(w$series, nar = 4, nma = 4, dtol = NULL, drange = c(0, 0.5), M = 100)
w<-fracdiff.sim(600, ma=0.7 , d=0.35)
plot(as.ts(w$series))
acf(z, lag.max=150)
# Verificación teórica del procedimiento
df_w<-diffseries(w$series, 0.35)
par(mfrow = c(3, 1))
plot(df_w, type="l")
acf(df_w)
pacf(df_w, ci=0)
# Procedimiento de Identificación
# Paso 1
modelo1<-fracdiff(w$series, nar = 4, nma = 4, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
modelo1<-fracdiff(w$series, nma = 1, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
(d_est=coef(modelo1)[1])
w<-fracdiff.sim(600, ma=0.7 , d=0.3)
plot(as.ts(w$series))
acf(z, lag.max=150)
# Verificación teórica del procedimiento
df_w<-diffseries(w$series, 0.35)
par(mfrow = c(3, 1))
plot(df_w, type="l")
acf(df_w)
pacf(df_w, ci=0)
# Procedimiento de Identificación
# Paso 1
modelo1<-fracdiff(w$series, nma = 1, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
(d_est=coef(modelo1)[1])
df_w <- diffseries(w$series, d_est)
df_w
par(mfrow = c(2, 1))
acf(df_w, ci=0)
pacf(df_w, ci=0)
modelo2 <- fracdiff(w$series, nar = 1, nma = 0,dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo2)
modelo2 <- fracdiff(w$series, nar = 0, nma = 1,dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo2)
petrobras<-read.table("ejemplo_0.txt", sep = "", dec=".")
petrobras<-read.table("ejemplo_0.txt", sep = "", dec=".")
z<-petrobras$V2
petrobras<-read.table("ejemplo_0.txt", sep = "", dec=".", header = T)
attach(petrobras)
z<-petro
par(mfrow = c(2, 1))
plot(as.ts(z), main="Retornos Petrobras");grid()
acf(z, lag.max=150)
spec.pgram(z, log="no")
modelo1<-fracdiff(z, nar = 8, nma = 0, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
d_est=coef(modelo1)[1]
df_z <- diffseries(z, d_est)
par(mfrow = c(2, 1))
acf(df_z, ci=0)
pacf(df_z)
modelo1<-fracdiff(z, nar = 8, nma = 0, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
d_est=coef(modelo1)[1]
petrobras<-read.table("ejemplo_0.txt", sep = "", dec=".", header = T)
attach(petrobras)
z<-petro
par(mfrow = c(2, 1))
plot(as.ts(z), main="Retornos Petrobras");grid()
acf(z, lag.max=150)
length(z)
acf(z, lag.max=500)
spec.pgram(z, log="no")
modelo1<-fracdiff(z, nar = 8, nma = 0, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
df_z <- diffseries(z, d_est)
par(mfrow = c(2, 1))
acf(df_z, ci=0)
pacf(df_z)
petrobras<-read.table("ejemplo_0.txt", sep = "", dec=".", header = T)
attach(petrobras)
z<-petro
length(z)
plot(as.ts(z), main="Retornos Petrobras");grid()
petrobras<-read.table("ejemplo_0.txt", sep = "", dec=".", header = T)
head(petrobras)
z<-petrobras$petro
length(z)
length(z)
par(mfrow = c(2, 1))
plot(as.ts(z), main="Retornos Petrobras");grid()
acf(z, lag.max=500)
spec.pgram(z, log="no")
spec.pgram(z, log="no")
modelo1<-fracdiff(z, nar = 8, nma = 0, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
(d_est=coef(modelo1)[1])
df_z <- diffseries(z, d_est)
par(mfrow = c(2, 1))
acf(df_z, ci=0)
pacf(df_z)
modelo2 <- fracdiff(z, nar = 1, nma = 0,dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo2)
names(modelo2)
residuals(modelo2)
res.df=residuals(modelo2)
res.df=residuals(modelo2)
acf(res.df)
pacf(res.df)
qqplot(res.df)
qqnorm(res.df)
qqline(res.df)
qqnorm(res.df, ylim=c(-3,3))
qqnorm(res.df, ylim=c(-5,5))
qqline(res.df)
library(MASS)
?truehist()
truehist(res.df)
shapiro.test(res.df)
res.df=residuals(modelo2)
acf(res.df)
pacf(res.df)
qqnorm(res.df, ylim=c(-5,5))
qqline(res.df)
qqnorm(res.df, ylim=c(-4,4))
qqline(res.df)
qqnorm(res.df, ylim=c(-3,3))
qqline(res.df)
library(MASS)
truehist(res.df)
shapiro.test(res.df)
pronostico=forecast(modelo2, h=20)
plot(pronostico)
(serie=read.table("arfima_noestac_norev_n.txt", header=TRUE))
attach(serie)
par(mfrow=c(2,1))
plot.ts(Z)
acf(Z, lag.max=100, ci=0)
dZ=diff(Z)
par(mfrow=c(2,1))
plot.ts(diff(Z))
acf(diff(Z), lag.max=100, ci=0)
acf(diff(Z), lag.max=100, ci=0)
?spec.pgram
spec.pgram(diff(Z), log="no")
(d_GPH=fdGPH(dZ))
(t_GPH=d_GPH$d/d_GPH$sd.as)
df_dZ=diffseries(dZ,d_GPH$d)
par(mfrow=c(3,1))
plot.ts(df_dZ)
acf(df_dZ, lag.max=20, ci=0)
pacf(df_dZ, lag.max=20)
d_GPH$d
se
(serie=read.table("arfima_noestac_norev_n.txt", header=TRUE))
attach(serie)
par(mfrow=c(2,1))
plot.ts(Z)
acf(Z, lag.max=100, ci=0)
dZ=diff(Z)
par(mfrow=c(2,1))
plot.ts(dZ)
acf(dZ, lag.max=100, ci=0)
spec.pgram(diff(Z), log="no")
(d_GPH=fdGPH(dZ))
(t_GPH=d_GPH$d/d_GPH$sd.as)
(perc_normal_05=qnorm(0.95))
df_dZ=diffseries(dZ, d_GPH$d)
par(mfrow=c(3,1))
plot.ts(df_dZ)
acf(df_dZ, lag.max=20, ci=0)
pacf(df_dZ, lag.max=20)
library(astsa)
plot.ts(varve)
plot.ts(log(varve))
X = acf(log(varve), 100, plot=FALSE)
plot(X[1:100], ylim=c(-.1,1), main="log(varve)") # get rid of lag 0
acf(log(varve), 100, plot=FALSE)
plot(X[1:100], ylim=c(-.1,1), main="log(varve)") # get rid of lag 0
library(fracdiff)
lvarve = log(varve)-mean(log(varve));plot.ts(log(varve)-mean(log(varve)))
varve.fd = fracdiff(lvarve, nar=0, nma=0, M=30)
names(varve.fd)
varve.fd$d # = 0.3841688
spec.pgram(lvarve, log="no", ylim=c(0,25))
varve.fd$stderror.dpq
spec.pgram(lvarve, log="no", ylim=c(0,25))
varve.fd$stderror.dpq
res.fd = diffseries(log(varve), varve.fd$d) # frac diff resids
res.fd
res.fd = diffseries(log(varve), varve.fd$d) # Residuo Fraccional
res.fd = diffseries(log(varve), varve.fd$d) # Residuo Fraccional
res.arima = resid(arima(log(varve), order=c(1,1,1))) # Residuo arima(1,1,1)
acf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
pacf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
par(mfrow=c(2,1))
acf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
pacf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
acf(res.fd, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARFIMA")
pacf(res.fd, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARFIMA")
par(mfrow=c(2,1))
acf(lvarve)
pacf(lvarve)
par(mfrow=c(2,1))
acf(diff(lvarve))
pacf(diff(lvarve))
acf(diff(lvarve))
pacf(diff(lvarve))
res.fd = diffseries(log(varve), varve.fd$d) # Residuo Fraccional
res.arima = resid(arima(log(varve), order=c(0,1,1))) # Residuo arima(1,1,1)
par(mfrow=c(2,1))
acf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
pacf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
acf(res.fd, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARFIMA")
pacf(res.fd, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARFIMA")
petro<-scan(dec = ",")
length(petro)
length(petro)
plot.ts(petro)
lpetro<-log(petro)
lpetro<-log(petro)
plot.ts(petro)
plot.ts(lpetro)
ac<-acf(lpetro, lag.max = 700)
plot(ac[1:200], ylim=c(-0.1,0.1), main="diff(log(petro))") # quitando lag 0
plot(ac[1:200], ylim=c(-0.1,1), main="diff(log(petro))") # quitando lag 0
plot(ac[1:200], ylim=c(-0.1,1), main="diff(log(petro))") # quitando lag 0
ac<-acf(lpetro, lag.max = 700)
plot(ac[1:700], ylim=c(-0.1,1), main="diff(log(petro))") # quitando lag 0
plot(ac[1:700], ylim=c(-0.1,1), main="log(petro)") # quitando lag 0
rpetro<-diff(lpetro)
plot.ts(lpetro)
plot.ts(rpetro)
acf(rpetro)
pacf(rpetro)
plot.ts(rpetro)
lpetro<-log(petro)
plot.ts(lpetro)
rpetro<-diff(lpetro)
plot.ts(rpetro)
acf(rpetro)
pacf(rpetro)
petro.fd = fracdiff(lpetro, nar=0, nma=0, M=30)
summary(petro.fd)
spec.pgram(lpetro, log="no")
summary(petro.fd)
acf(rpetro)
dfl<-diffseries(lpetro, petro.fd$d)
acf(dfl)
dfl<-diffseries(lpetro, petro.fd$d)
acf(dfl)
pacf(dfl)
petro.fd = fracdiff(lpetro, nar=0, nma=0, M=30)
summary(petro.fd)
acf(dfl)
pacf(dfl)
acf(rpetro)
pacf(rpetro)
h<-0:500
d=1
f<-h^(2*d-1)
plot(h,f)
plot(h,f, type="h")
h<-0:500
d=0.5
f<-h^(2*d-1)
plot(h,f, type="h")
d=0.45
f<-h^(2*d-1)
plot(h,f, type="h")
h<-0:500
d=1.2
f<-h^(2*d-1)
plot(h,f, type="h")
d=1
f<-h^(2*d-1)
plot(h,f, type="h")
d=0.8
f<-h^(2*d-1)
plot(h,f, type="h")
d=0.5
f<-h^(2*d-1)
plot(h,f, type="h")
d=0.45
f<-h^(2*d-1)
plot(h,f, type="h")
d=0.1
f<-h^(2*d-1)
plot(h,f, type="h")
d=-0.1
f<-h^(2*d-1)
plot(h,f, type="h")
d=-0.4
f<-h^(2*d-1)
plot(h,f, type="h")
d=-0.5
f<-h^(2*d-1)
plot(h,f, type="h")
d=-1
f<-h^(2*d-1)
plot(h,f, type="h")
d=-2
f<-h^(2*d-1)
plot(h,f, type="h")
d=-23
f<-h^(2*d-1)
plot(h,f, type="h")
d=1.2
f<-h^(2*d-1)
plot(h,f, type="h")
petrobras<-read.table("ejemplo_0.txt", sep = "", dec=".", header = T)
head(petrobras)
attach(petrobras)
z<-petrobras$petro
length(z)
par(mfrow = c(2, 1))
plot(as.ts(z), main="Retornos Petrobras");grid()
acf(z, lag.max=500)
par(mfrow = c(3, 1))
plot(as.ts(z), main="Retornos Petrobras");grid()
acf(z, lag.max=500)
spec.pgram(z, log="no")
spec.pgram(z, log="no")
modelo1<-fracdiff(z, nar = 8, nma = 0, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
modelo1<-fracdiff(z, nar = 8, nma = 0, dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo1)
(d_est=coef(modelo1)[1])
df_z <- diffseries(z, d_est)
df_z <- diffseries(z, d_est) #Diferencia fraccionaria
par(mfrow = c(2, 1))
acf(df_z, ci=0)
pacf(df_z)
length(z)
acf(df_z, ci=0, lag.max =100 )
pacf(df_z)
pacf(df_z, lag.max =100)
acf(df_z, ci=0, lag.max =100)
pacf(df_z, lag.max =100)
acf(df_z, ci=0, lag.max =100)
acf(df_z, ci=0, lag.max =100)
pacf(df_z, lag.max =100)
df_z
(d_est=coef(modelo1)[1])
modelo2 <- fracdiff(z, nar = 1, nma = 0,dtol = NULL, drange = c(0, 0.5), M = 100)
summary(modelo2)
res.df=residuals(modelo2)
acf(res.df)
pacf(res.df)
qqnorm(res.df, ylim=c(-3,3))
qqline(res.df)
qqline(res.df, col="red")
library(MASS)
truehist(res.df)
shapiro.test(res.df)
library(forecast)
pronostico=forecast(modelo2, h=20)
plot(pronostico)
(serie=read.table("arfima_noestac_norev_n.txt", header=TRUE))
attach(serie)
par(mfrow=c(2,1))
plot.ts(Z)
acf(Z, lag.max=100, ci=0)
dZ=diff(Z)
par(mfrow=c(2,1))
plot.ts(dZ)
acf(dZ, lag.max=100, ci=0)
dZ=diff(Z)
par(mfrow=c(2,1))
plot.ts(dZ)
acf(dZ, lag.max=100, ci=0)
library(stats)
spec.pgram(diff(Z), log="no")
spec.pgram(diff(Z), log="no")
(d_GPH=fdGPH(dZ))
(t_GPH=d_GPH$d/d_GPH$sd.as)
(perc_normal_05=qnorm(0.95))
library(astsa)
plot.ts(varve)
plot.ts(log(varve))
X = acf(log(varve), 100, plot=FALSE)
plot(X[1:100], ylim=c(-.1,1), main="log(varve)") # get rid of lag 0
lvarve = log(varve)-mean(log(varve));plot.ts(log(varve)-mean(log(varve)))
varve.fd = fracdiff(lvarve, nar=0, nma=0, M=30)
names(varve.fd)
varve.fd$d
spec.pgram(lvarve, log="no", ylim=c(0,25))
X = acf(log(varve), 100, plot=FALSE)
plot(X[1:100], ylim=c(-.1,1), main="log(varve)") # get rid of lag 0
plot.ts(log(varve))
X = acf(log(varve), 100, plot=FALSE)
plot.ts(varve)
plot.ts(log(varve))
X = acf(log(varve), 100, plot=FALSE)
plot(X[1:100], ylim=c(-.1,1), main="log(varve)") # get rid of lag 0
library(fracdiff)
lvarve = log(varve)-mean(log(varve));plot.ts(log(varve)-mean(log(varve)))
X = acf(log(varve), 100, plot=FALSE)
pacf(log(varve))
length(varve)
pacf(log(varve), lag.max = 100)
plot(X[1:100], ylim=c(-.1,1), main="log(varve)") # Quitar lag 0
pacf(log(varve), lag.max = 100)
lvarve = log(varve)-mean(log(varve));plot.ts(log(varve)-mean(log(varve)))
varve.fd = fracdiff(lvarve, nar=0, nma=0, M=30)
names(varve.fd)
varve.fd$d
res.fd = diffseries(log(varve), varve.fd$d) # Residuo Fraccional
plot.ts(log(varve))
X = acf(log(varve), 100, plot=FALSE)
plot(X[1:100], ylim=c(-.1,1), main="log(varve)") # Quitar lag 0
pacf(log(varve), lag.max = 100)
spec.pgram(lvarve, log="no", ylim=c(0,25))
library(fracdiff)
lvarve = log(varve)-mean(log(varve));plot.ts(log(varve)-mean(log(varve)))
plot.ts(lvarve)
plot.ts(lvarve)
ac = acf(log(varve), 100, plot=FALSE)
plot(ac[1:100], ylim=c(-.1,1), main="log(varve)") # Quitar lag 0
pacf(log(varve), lag.max = 100)
varve.fd = fracdiff(lvarve, nar=0, nma=0, M=30)
summary(varve.fd)
varve.fd$d
par(mfrow=c(2,1))
acf(diff(lvarve))
pacf(diff(lvarve))
plot(X[1:100], ylim=c(-.1,1), main="log(varve)") # Quitar lag 0
pacf(log(varve), lag.max = 100)
plot.ts(varve)
length(varve)
plot.ts(log(varve))
X = acf(log(varve), 100, plot=FALSE)
par(mfrow=c(2,1))
plot(ac[1:100], ylim=c(-.1,1), main="log(varve)") # Quitar lag 0
pacf(log(varve), lag.max = 100)
ac = acf(log(varve), 100, plot=FALSE)
par(mfrow=c(2,1))
plot(ac[1:100], ylim=c(-.1,1), main="log(varve)") # Quitar lag 0
pacf(log(varve), lag.max = 100)
ac = acf(log(varve), 100, plot=FALSE, ci=0)
par(mfrow=c(2,1))
plot(ac[1:100], ylim=c(-.1,1), main="log(varve)") # Quitar lag 0
plot(ac[1:100], ylim=c(-.1,1), main="log(varve)", ci=0) # Quitar lag 0
plot(ac[1:100], ylim=c(-.1,1), main="log(varve)", ci=0) # Quitar lag 0
pacf(log(varve), lag.max = 100)
varve.fd = fracdiff(lvarve, nar=5, nma=0, M=30)
summary(varve.fd)
varve.fd = fracdiff(lvarve, nar=5, nma=0, M=30)
summary(varve.fd)
varve.fd = fracdiff(lvarve, nar=0, nma=0, M=30)
summary(varve.fd)
varve.fd$d
summary(varve.fd)
res.fd = diffseries(log(varve), varve.fd$d) # Residuo Fraccional
res.arima = resid(arima(log(varve), order=c(0,1,1))) # Residuo arima(1,1,1)
par(mfrow=c(2,1))
acf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
pacf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
res.fd = diffseries(lvarve, varve.fd$d) # Residuo Fraccional
res.arima = resid(arima(lvarve, order=c(0,1,1))) # Residuo arima(1,1,1)
par(mfrow=c(2,1))
acf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
pacf(res.arima, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARIMA")
acf(res.fd, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARFIMA")
pacf(res.fd, 100, xlim=c(4,97), ylim=c(-.2,.2), main="ARFIMA")
petro<-scan(dec = ",")
petro<-scan(dec = ",")
length(petro)
plot.ts(petro)
plot.ts(petro)
plot.ts(petro)
lpetro<-log(petro)
plot.ts(lpetro)
ac<-acf(lpetro, lag.max = 700)
plot(ac[1:700], ylim=c(-0.1,1), main="log(petro)") # quitando lag 0
spec.pgram(lpetro, log="no")
rpetro<-diff(lpetro)
plot.ts(rpetro)
acf(rpetro)
pacf(rpetro)
petro.fd = fracdiff(lpetro, nar=0, nma=0, M=30)
summary(petro.fd)
dfl<-diffseries(lpetro, petro.fd$d)
acf(dfl)
pacf(dfl)
